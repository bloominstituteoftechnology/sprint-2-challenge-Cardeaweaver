<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Web Sprint 2 Challenge</title>
    <script id="challenge">
      // ðŸ‘‰ CHALLENGE 1
      function profileActivation(profile, reason) {
        if (profile.active) {
          // If profile is active
          if (reason) {
            // If reason is provided
            profile.active = false; // Set profile to inactive
            profile.reason = reason; // Assign reason
          } else {
            return "confirm status manually"; // Return confirmation needed
          }
        } else {
          // If profile is inactive
          profile.active = true; // Set profile to active
          delete profile.reason; // Remove reason property
        }

        return profile; // Return updated profile
      }

      //   }

      //   // toggle active status
      //   profile.active = !profile.active;
      // ðŸ‘‰ CHALLENGE 2
      function mineSweeper(grid, x, y) {
        // Check if the coordinates are valid

        if ((x <1 || x >3 ) || (y < 1 || y > 3 )) {
          return "invalid coordinates"; 
        }
       // your have hit a bomb
        if (grid[y-1]  [x - 1] ==="ðŸŸ¥"){
          return "ðŸŸ¥ ðŸ’€"
        }
        if (grid[y-1]  [x - 1] ==="ðŸŸ¦"){
          return "ðŸŸ¦ ðŸ¥³"
        }
      }
      //     let result = mineSweeper(grid, 4, 1);
      //   {
      //     console.log(result);
      //   }
      //   // Retrieve the value at the given coordinates
      //   const cellValue = grid[x][y];

      //   // Check if the cell contains a mine
      //   if (cellValue === "ðŸŸ¥") {
      //     return `"ðŸŸ¥ ðŸ’€"`; // Return if the cell contains a mine
      //   } else {
          
      //     return "Safe move!"; // Return if the cell is safe
      //   }
      // }

      // ðŸ‘‰ CHALLENGE 3
      function booleanize(obj) {
     
        for (let prop in obj) {
        
          if (prop.length > 9) {
            return "shorten all prop names to 9 chars or less"; // Return error message
          }

         
          if (obj[prop] === 0) {
            
            obj[prop] = false;
          
          } else if (obj[prop] === 1) {
            obj[prop] = true;
          }  if (obj[prop] === null) {
            delete obj[prop];
          }
        }
        return obj;
      }

      // ðŸ‘‰ CHALLENGE 4
      function scrub(text, forbidden) {

        if (!text || forbidden.length === 0) {
          return text;
        }

        // Create a regular expression to match all forbidden words
        const regex = new RegExp(`\\b(${forbidden.join("|")})\\b`, "gi");

        // Replace each forbidden word with "x" characters of equal length
        return text.replace(regex, (word) => "x".repeat(word.length));
      }
      // ðŸ‘‰ CHALLENGE 5 (bonus, NOT graded)
      function normalizePhoneNumber(num) {
        // Extract the area code, prefix, and line number
        const areaCode = num.substring(0, 3);
        const prefix = num.substring(3, 6);
        const lineNumber = num.substring(6);

        // Format the phone number as "(XXX) XXX-XXXX"
        return `(${areaCode}) ${prefix}-${lineNumber}`;
      }

      // ðŸ‘‰ CHALLENGE 6 (bonus, NOT graded)
      function diceRolls() {
        let consecutiveSixes = 0; // Counter for consecutive sixes
        let totalRolls = 0; // Total number of rolls

        // Continue rolling until three consecutive sixes are achieved
        while (consecutiveSixes < 3) {
          const roll = Math.floor(Math.random() * 6) + 1; // Simulate rolling a six-sided die
          totalRolls++; // Increment total rolls

          // If the roll is a six, increment consecutive sixes; otherwise, reset it
          if (roll === 6) {
            consecutiveSixes++;
          } else {
            consecutiveSixes = 0;
          }
        }

        return totalRolls; // Return the total number of rolls
      }

      // ðŸ§ª DO NOT make any changes below this line ===================
      globalThis.challengeVersion = 1;
      globalThis.profileActivation = profileActivation;
      globalThis.mineSweeper = mineSweeper;
      globalThis.booleanize = booleanize;
      globalThis.scrub = scrub;
    </script>
    <style>
      .widget {
        padding: 0 0 0.5rem 0.65rem;
        margin-bottom: 0.5rem;
        border: 1px solid black;
        border-radius: 0.5rem;
      }

      .widget p {
        font-size: 0.75rem;
        font-style: italic;
      }

      .row > div {
        display: inline-block;
        background-color: lightgrey;
        border: 1px solid grey;
        width: 2rem;
        height: 2rem;
        cursor: pointer;
      }

      #outcome {
        font-size: 3rem;
      }
    </style>
  </head>

  <body>
    <h1>Web Sprint 2 Challenge</h1>
    <p>Open this HTML document in VSCode to find your challenges</p>
    <!-- widgets start -->
    <section class="widget">
      <p>Click on a square! (this widget uses the mineSweeper function)</p>
      <div class="row" id="row1">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <div class="row" id="row2">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <div class="row" id="row3">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <span id="outcome"></span>
    </section>
    <form class="widget">
      <p>
        Type a ten-digit number! (this widget uses the normalizePhoneNumber
        function)
      </p>
      <input type="text" id="phoneNumInput" maxlength="10" />
      <span id="normalized"></span>
    </form>
    <!-- widgets end -->

    <!-- The following script loads from the Internet a library called Lodash that helps with testing -->
    <script
      id="lodash"
      src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"
    ></script>
    <!-- The following script executes the tests you see when you open the Console in Chrome -->
    <script id="tests">
      runTests("CHALLENGE 1 - profileActivation", profileActivation, [
        [[{ active: true }], "confirm status manually"],
        [[{ active: true }, "because"], { active: false, reason: "because" }],
        [[{ active: false, reason: "because" }], { active: true }],
      ]);
      runTests("CHALLENGE 2 - mineSweeper", mineSweeper, [
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
            ],
            0,
            4,
          ],
          "invalid coordinates",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
            ],
            0,
            1,
          ],
          "invalid coordinates",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
            ],
            1,
            4,
          ],
          "invalid coordinates",
        ],
        [
          [
            [
              ["ðŸŸ¦", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¦", "ðŸŸ¦", "ðŸŸ¥"],
            ],
            1,
            1,
          ],
          "ðŸŸ¦ ðŸ¥³",
        ],
        [
          [
            [
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¦"],
              ["ðŸŸ¦", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
            ],
            2,
            1,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
            ],
            3,
            1,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¦", "ðŸŸ¦"],
            ],
            1,
            2,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¦"],
            ],
            2,
            2,
          ],
          "ðŸŸ¦ ðŸ¥³",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
            ],
            3,
            2,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
            ],
            1,
            3,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¥"],
            ],
            2,
            3,
          ],
          "ðŸŸ¦ ðŸ¥³",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¦", "ðŸŸ¥", "ðŸŸ¥"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
            ],
            3,
            3,
          ],
          "ðŸŸ¦ ðŸ¥³",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
            ],
            1,
            1,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
            ],
            2,
            2,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
        [
          [
            [
              ["ðŸŸ¥", "ðŸŸ¦", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¦"],
              ["ðŸŸ¥", "ðŸŸ¥", "ðŸŸ¥"],
            ],
            3,
            3,
          ],
          "ðŸŸ¥ ðŸ’€",
        ],
      ]);
      runTests("CHALLENGE 3 - booleanize", booleanize, [
        [[{ bad1: null }], {}],
        [[{ bad1: null, bad2: null }], {}],
        [[{ "0123456789": 1 }], "shorten all prop names to 9 chars or less"],
        [[{ a: 1, b: 1 }], { a: true, b: true }],
        [[{ a: 0, b: 0 }], { a: false, b: false }],
        [
          [{ a: 1, b: 0, c: null, d: "Lady Gaga" }],
          { a: true, b: false, d: "Lady Gaga" },
        ],
      ]);
      runTests("CHALLENGE 4 - scrub", scrub, [
        [
          ["out of the silent planet", ["of", "silent"]],
          "out xx the xxxxxx planet",
        ],
        [
          ["out of the silent planet", ["of", "planet"]],
          "out xx the silent xxxxxx",
        ],
        [["the ghost of the navigator", ["the"]], "xxx ghost of xxx navigator"],
        [["lost somewhere in time", []], "lost somewhere in time"],
        [["aces high", ["high", "aces", "hearts"]], "xxxx xxxx"],
        [["", ["high", "aces"]], ""],
      ]);
      runTests(
        "CHALLENGE 5 (OPTIONAL) - normalizePhoneNumber",
        normalizePhoneNumber,
        [
          [["1234567890"], "(123) 456-7890"],
          [["1111111111"], "(111) 111-1111"],
          [["9876543210"], "(987) 654-3210"],
        ]
      );
      console.log(
        "\nCHALLENGE 6 (OPTIONAL) does not have auto tests - diceRolls"
      );
      function runTests(testName, func, tests) {
        let results = [];
        tests.forEach((test) => {
          const originalArgsList = _.cloneDeep(test[0]);
          const argsList = test[0];
          const expected = test[1];
          const actual = func.apply(null, argsList);
          results.push([argsList, expected, actual, originalArgsList]);
        });
        console.log("\n" + testName);
        if (results.every((result) => _.isEqual(result[1], result[2])))
          console.log("\tâœ… All tests pass");
        else if (results.every((result) => !_.isEqual(result[1], result[2])))
          console.log("\tâŒ All tests fail");
        else
          results.forEach((result, idx) => {
            if (_.isEqual(result[1], result[2]))
              console.log(`\tâœ… Test ${idx + 1} passes`);
            else
              console.log(`\tâŒ Test ${idx + 1} fails:
           ${func.name}(${result[3].map(JSON.stringify)})
           ðŸ‘‰ should return ${JSON.stringify(result[1])}
           ðŸ‘‰ but returns ${JSON.stringify(result[2])}`);
          });
      }
      const gridElems = [
        Array.from(row1.children),
        Array.from(row2.children),
        Array.from(row3.children),
      ];
      const squares = ["ðŸŸ¥", "ðŸŸ¦"];
      let grid = [[], [], []];
      gridElems.forEach((row, idxRow) => {
        row.forEach((square, idxSquare) => {
          const emoji = squares[Math.floor(Math.random() * 2)];
          grid[idxRow].push(emoji);
          if (emoji === squares[0]) square.style.backgroundColor = "#ffecec";
          else square.style.backgroundColor = "#f2f2ff";
          square.onclick = () => {
            const x = idxSquare + 1;
            const y = idxRow + 1;
            console.log(`\nYou clicked coordinates [${x}, ${y}]`);
            outcome.textContent = mineSweeper(grid, x, y);
          };
        });
      });
      phoneNumInput.oninput = (evt) => {
        normalized.textContent = normalizePhoneNumber(evt.target.value);
      };
    </script>
  </body>
</html>
